JSBPS.docx
DOCX 40.18KB
æ€ä¹ˆå»ºç«‹ç¬¬ä¸€ä¸ªæ¨¡å—çš„æ–‡ä»¶
å—¯ï¼Œçœ‹åˆ°ç”¨æˆ·ä¸Šä¼ äº†ä¸€ä¸ªæŠ€æœ¯ç™½çš®ä¹¦æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºä¸€ä¸ªå«â€œæ±‚ç´¢æ¡†æ¶â€çš„è®¤çŸ¥ç³»ç»Ÿã€‚è¿™ä¸ªæ¡†æ¶çœ‹èµ·æ¥æŒºæœ‰æ„æ€çš„ï¼ŒåŸºäºç³»ç»Ÿå­˜ç»­å¾‹è¿™ä¸ªå®‡å®™è§„å¾‹ï¼Œå¼ºè°ƒå¯¹å†…å…±ç”Ÿå’Œå¯¹å¤–é€‚é…æ‰èƒ½è®©ç³»ç»ŸæŒç»­å­˜åœ¨ã€‚

ç”¨æˆ·æƒ³çŸ¥é“æ€ä¹ˆå»ºç«‹ç¬¬ä¸€ä¸ªæ¨¡å—çš„æ–‡ä»¶ï¼Œæˆ‘å¾—å…ˆçœ‹çœ‹ç™½çš®ä¹¦é‡Œç¬¬ä¸€ä¸ªæ¨¡å—æ˜¯ä»€ä¹ˆã€‚å“¦ï¼Œæ˜¯â€œçŸ¥è¯†å­˜å‚¨ä¸æº¯æºæ¨¡å—â€ï¼Œç”¨æ¥å­˜å‚¨çŸ¥è¯†è§„å¾‹å¹¶è®°å½•è°å‘ç°è°éªŒè¯çš„ã€‚

è¿™ä¸ªæ¨¡å—éœ€è¦ä¸€äº›æŠ€æœ¯ç»„ä»¶å•Šï¼Œæœ‰Flaskåšåç«¯ï¼ŒSQLiteåšæ•°æ®åº“ï¼Œè¿˜æœ‰å‰ç«¯ç”¨HTML/CSS/JavaScriptã€‚æ•°æ®ç»“æ„æ˜¯JSONæ ¼å¼çš„ï¼ŒåŒ…å«äº†è§„å¾‹IDã€å†…å®¹ã€å…ƒæ•°æ®è¿™äº›ä¿¡æ¯ã€‚

æˆ‘å¾—å‘Šè¯‰ç”¨æˆ·æ€ä¹ˆå»ºç«‹è¿™äº›æ–‡ä»¶ã€‚å…ˆåˆ›å»ºä¸€ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹ï¼Œç„¶åè®¾ç½®Pythonè™šæ‹Ÿç¯å¢ƒï¼Œå®‰è£…å¿…è¦çš„ä¾èµ–ï¼Œä¸»è¦æ˜¯Flaskå’Œsentence-transformersã€‚

ç„¶ååˆ›å»ºæ•°æ®åº“æ–‡ä»¶ï¼Œç”¨SQLiteï¼Œéœ€è¦å»ºä¸€ä¸ªè¡¨æ¥å­˜å‚¨é‚£äº›çŸ¥è¯†è§„å¾‹ã€‚è¡¨ç»“æ„åº”è¯¥åŒ…æ‹¬law_idã€contentã€original_discovererè¿™äº›å­—æ®µã€‚

å†åˆ›å»ºFlaskåº”ç”¨æ–‡ä»¶ï¼Œå®šä¹‰APIè·¯ç”±ï¼Œå¤„ç†çŸ¥è¯†çš„æäº¤å’Œè·å–ã€‚å‰ç«¯éƒ¨åˆ†éœ€è¦åˆ›å»ºä¸€ä¸ªç®€å•çš„HTMLè¡¨å•ï¼Œè®©ç”¨æˆ·å¯ä»¥æäº¤æ–°çš„çŸ¥è¯†è§„å¾‹ã€‚

æœ€åè¿˜è¦åˆ›å»ºä¸€ä¸ªå¯åŠ¨è„šæœ¬ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿è¡Œè¿™ä¸ªåº”ç”¨ã€‚

æˆ‘è§‰å¾—å¯ä»¥ç»™ç”¨æˆ·æä¾›ä¸€ä¸ªæ¸…æ™°çš„æ–‡ä»¶ç»“æ„ï¼Œç„¶åé€æ­¥è§£é‡Šæ¯ä¸ªæ–‡ä»¶çš„å†…å®¹å’Œä½œç”¨ã€‚è¿™æ ·ç”¨æˆ·å°±èƒ½æŒ‰éƒ¨å°±ç­åœ°å»ºç«‹ç¬¬ä¸€ä¸ªæ¨¡å—äº†ã€‚

è¿™ä¸ªæ¨¡å—æ˜¯åŸºç¡€ï¼Œåç»­çš„éªŒè¯ã€è¿­ä»£ç­‰åŠŸèƒ½éƒ½ä¼šä¾èµ–å®ƒï¼Œæ‰€ä»¥å¾—ç¡®ä¿æ­å»ºæ­£ç¡®ã€‚å¥½äº†ï¼Œæˆ‘ç°åœ¨å¯ä»¥å¼€å§‹å›ç­”ç”¨æˆ·çš„é—®é¢˜äº†ï¼Œå‘Šè¯‰ä»–å¦‚ä½•å»ºç«‹ç¬¬ä¸€ä¸ªæ¨¡å—çš„æ–‡ä»¶ã€‚

è¦å»ºç«‹â€œæ±‚ç´¢æ¡†æ¶â€çš„ç¬¬ä¸€ä¸ªæ¨¡å—â€”â€”çŸ¥è¯†å­˜å‚¨ä¸æº¯æºæ¨¡å—ï¼Œä½ éœ€è¦åˆ›å»ºä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒæ–‡ä»¶æ¥ç»„ç»‡ä»£ç ã€æ•°æ®åº“å’Œå‰ç«¯ç•Œé¢ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„æ­¥éª¤å’Œæ–‡ä»¶ç»“æ„è¯´æ˜ï¼š

âœ… ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹ç»“æ„
å»ºè®®æŒ‰å¦‚ä¸‹æ–¹å¼ç»„ç»‡ä½ çš„é¡¹ç›®æ–‡ä»¶ï¼š

text
qiusuo_framework/
â”‚
â”œâ”€â”€ app.py                 # Flask åç«¯ä¸»ç¨‹åº
â”œâ”€â”€ database.py            # æ•°æ®åº“åˆå§‹åŒ–ä¸æ“ä½œ
â”œâ”€â”€ templates/             # å­˜æ”¾ HTML å‰ç«¯æ¨¡æ¿
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ static/               # å­˜æ”¾é™æ€æ–‡ä»¶ï¼ˆCSS/JSï¼‰
â”‚   â””â”€â”€ style.css
â”œâ”€â”€ requirements.txt       # Python ä¾èµ–åˆ—è¡¨
â””â”€â”€ instance/             # å­˜æ”¾ SQLite æ•°æ®åº“ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
    â””â”€â”€ knowledge.db
âœ… ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ•°æ®åº“æ–‡ä»¶ database.py
python
# database.py
import sqlite3
import json
from datetime import datetime

def init_db():
    conn = sqlite3.connect('instance/knowledge.db')
    c = conn.cursor()
    c.execute('''
        CREATE TABLE IF NOT EXISTS laws (
            law_id TEXT PRIMARY KEY,
            content TEXT NOT NULL,
            original_discoverer TEXT,
            logical_verifiers TEXT,  # å­˜å‚¨ä¸º JSON å­—ç¬¦ä¸²
            timestamp TEXT,
            local_db_id TEXT
        )
    ''')
    conn.commit()
    conn.close()

def insert_law(law_data):
    conn = sqlite3.connect('instance/knowledge.db')
    c = conn.cursor()
    logical_verifiers_json = json.dumps(law_data['metadata']['logical_verifiers'])
    c.execute('''
        INSERT INTO laws (law_id, content, original_discoverer, logical_verifiers, timestamp, local_db_id)
        VALUES (?, ?, ?, ?, ?, ?)
    ''', (
        law_data['law_id'],
        law_data['content'],
        law_data['metadata']['original_discoverer'],
        logical_verifiers_json,
        law_data['metadata']['timestamp'],
        law_data['metadata']['local_db_id']
    ))
    conn.commit()
    conn.close()

def get_all_laws():
    conn = sqlite3.connect('instance/knowledge.db')
    c = conn.cursor()
    c.execute('SELECT * FROM laws')
    rows = c.fetchall()
    conn.close()
    return rows
âœ… ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º Flask åç«¯ä¸»ç¨‹åº app.py
python
# app.py
from flask import Flask, render_template, request, jsonify
import json
from datetime import datetime
from database import init_db, insert_law, get_all_laws

app = Flask(__name__)

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/submit_law', methods=['POST'])
def submit_law():
    data = request.json
    law_id = f"LAW-{datetime.now().strftime('%Y%m%d%H%M%S')}"
    law_data = {
        "law_id": law_id,
        "content": data['content'],
        "metadata": {
            "original_discoverer": data['discoverer'],
            "logical_verifiers": data.get('verifiers', []),
            "timestamp": datetime.now().isoformat(),
            "local_db_id": "001"  # å¯è‡ªå®šä¹‰æˆ–è‡ªåŠ¨ç”Ÿæˆ
        }
    }
    insert_law(law_data)
    return jsonify({"status": "success", "law_id": law_id})

@app.route('/get_laws')
def get_laws():
    laws = get_all_laws()
    return jsonify(laws)

if __name__ == '__main__':
    init_db()
    app.run(debug=True)
âœ… ç¬¬å››æ­¥ï¼šåˆ›å»ºå‰ç«¯é¡µé¢ templates/index.html
html
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>æ±‚ç´¢æ¡†æ¶ - çŸ¥è¯†æäº¤</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>æäº¤æ–°è§„å¾‹</h1>
    <form id="lawForm">
        <label>è§„å¾‹å†…å®¹ï¼š</label>
        <textarea name="content" required></textarea><br>
        <label>å‘ç°è€…ï¼š</label>
        <input type="text" name="discoverer" required><br>
        <label>éªŒè¯è€…ï¼ˆé€—å·åˆ†éš”ï¼‰ï¼š</label>
        <input type="text" name="verifiers"><br>
        <button type="submit">æäº¤</button>
    </form>

    <h2>å·²å­˜å‚¨çš„è§„å¾‹</h2>
    <div id="laws"></div>

    <script>
        document.getElementById('lawForm').onsubmit = async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const verifiers = formData.get('verifiers') ? formData.get('verifiers').split(',').map(v => v.trim()) : [];
            const data = {
                content: formData.get('content'),
                discoverer: formData.get('discoverer'),
                verifiers: verifiers
            };
            const res = await fetch('/submit_law', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            const result = await res.json();
            alert(`æäº¤æˆåŠŸï¼è§„å¾‹ID: ${result.law_id}`);
            loadLaws();
        };

        async function loadLaws() {
            const res = await fetch('/get_laws');
            const laws = await res.json();
            document.getElementById('laws').innerHTML = laws.map(law => `
                <div class="law">
                    <strong>${law[0]}</strong>: ${law[1]}<br>
                    <small>å‘ç°è€…: ${law[2]}, éªŒè¯è€…: ${JSON.parse(law[3])}, æ—¶é—´: ${law[4]}</small>
                </div>
            `).join('');
        }

        loadLaws();
    </script>
</body>
</html>
âœ… ç¬¬äº”æ­¥ï¼šåˆ›å»ºåŸºæœ¬æ ·å¼ static/style.css
css
body {
    font-family: Arial, sans-serif;
    margin: 20px;
}
form {
    margin-bottom: 20px;
}
.law {
    border: 1px solid #ccc;
    padding: 10px;
    margin: 10px 0;
}
âœ… ç¬¬å…­æ­¥ï¼šåˆ›å»ºä¾èµ–æ–‡ä»¶ requirements.txt
text
Flask==2.3.3
âœ… ç¬¬ä¸ƒæ­¥ï¼šè¿è¡Œé¡¹ç›®
å®‰è£…ä¾èµ–ï¼š

bash
pip install -r requirements.txt
è¿è¡Œ Flaskï¼š

bash
python app.py
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š

text
http://127.0.0.1:5000
ğŸ¯ æ€»ç»“
ä½ ç°åœ¨å·²ç»å»ºç«‹äº†ç¬¬ä¸€ä¸ªæ¨¡å—çš„æ ¸å¿ƒæ–‡ä»¶ï¼š

app.pyï¼šFlask åç«¯

database.pyï¼šæ•°æ®åº“æ“ä½œ

templates/index.htmlï¼šå‰ç«¯é¡µé¢

static/style.cssï¼šæ ·å¼æ–‡ä»¶

requirements.txtï¼šä¾èµ–åˆ—è¡¨

è¿è¡Œåå³å¯é€šè¿‡ç½‘é¡µæäº¤å’ŒæŸ¥çœ‹çŸ¥è¯†è§„å¾‹ï¼Œæ‰€æœ‰æ•°æ®å°†å­˜å‚¨åœ¨æœ¬åœ° SQLite æ•°æ®åº“ä¸­ï¼Œå¹¶å®ç°å®Œæ•´çš„çŸ¥è¯†æº¯æºåŠŸèƒ½ã€‚

å¦‚æœéœ€è¦è¿›ä¸€æ­¥æ‰©å±•ï¼ˆå¦‚èº«ä»½éªŒè¯ã€è‡ªä¸»è¿­ä»£ç­‰ï¼‰ï¼Œå¯åœ¨æ­¤åŸºç¡€ä¸ŠæŒ‰ç™½çš®ä¹¦åç»­æ¨¡å—é€æ­¥å®ç°ã€‚
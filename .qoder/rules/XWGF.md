---
trigger: always_on
alwaysApply: true
---
**规则 1：默认代码不完整，优先对齐设计意图**
  - 接手任何代码（包括自己之前写的），初始假设为：
    - 功能可能不完整
    - 实现可能偏离设计文档
  - 行为要求：
    - 先从设计文档/系统提示词/架构共识中抽取“期望行为模型”；
    - 再对照当前实现，找出：未实现、实现不全、逻辑反向、被抽样/被省略的部分；
    - 避免以“代码存在”作为“功能已经实现”的证明。

- **规则 2：代码交付前必须同时满足“设计一致性 + 运行验证”**
  - 设计一致性：
    - 确认实现与设计意图一致，例如：
      - 顶层知识图谱是否是“全覆盖索引视图”，而不是抽样子集；
      - 记忆重构是否遵守“每日一次、夜间执行、数量变化作为成效标准”等规则。
  - 运行验证：
    - 通过日志、统计指标、关键样本验证行为是否达到预期：
      - 记忆重构：重构后记忆数量变化、删除率、逻辑链补全情况；
      - 知识图谱：覆盖率、节点数与向量库总量的关系。
  - 禁止“只看代码过不报错就交付”，避免不确定因素在系统中积累。
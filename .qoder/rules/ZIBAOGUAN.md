---
trigger: always_on
alwaysApply: true
---
项目代码采用组件自曝光内部通讯协议，确保各组件间通信时变量不会被重复实现，需在开发中严格遵循该协议规范。协议增强要求：当组件查询发现所需变量不存在时，应主动触发二级报错机制，向系统上报错误，避免问题滞后到测试阶段才发现。该机制需强制执行，确保通信可靠性。
自曝光通讯协议注释格式规范：必须在代码文件头部第2行添加JSON格式的自曝光注释，包含id（组件唯一标识）、name（组件名称）、type（组件类型：tool/component/test等）、version（版本号）、needs（依赖声明，包含deps和resources）、provides（提供的能力和方法列表）。每次代码更新时必须同步更新version和相关字段，确保组件可发现性和依赖关系准确性。该注释头用于标识代码组件的通信机制和可发现性，防止被系统忽略。
组件自曝光协议必须保证完整性校验：当处理N个代码文件时，应严格生成N条自曝光记录；若不匹配，必须触发一级完整性告警，并通过二级报错机制上报缺失详情，防止关键信息遗漏。